<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta firstName="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>House MD</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="css/mdb.min.css" rel="stylesheet">
    <!-- Your custom styles (optional) -->
    <link href="css/style.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-2.1.3.js"
        integrity="sha256-goy7ystDD5xbXSf+kwL4eV6zOPJCEBD1FBiCElIm+U8=" crossorigin="anonymous"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.8/vue.min.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
    <!-- <script defer src="https://use.fontawesome.com/releases/v5.0.0/js/all.js"></script> -->

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css">
</head>
<style>
    * {
        box-sizing: border-box
    }

    body {
        font-family: "Lato", sans-serif;
    }

    /* Style the tab */
    .tab {
        float: left;
        border: 1px solid #ccc;
        background: linear-gradient(40deg, #303f9f, #45cafc);
        width: 14%;
        height: 100vh;
        margin-top: 75px;
    }

    /* Style the buttons inside the tab */
    .tab button {
        display: block;
        background-color: inherit;
        color: white;
        padding: 22px 16px;
        width: 100%;
        border: none;
        outline: none;
        text-align: left;
        cursor: pointer;
        transition: 0.3s;
        font-size: 17px;
    }

    /* Change background color of buttons on hover */
    .tab button:hover {
        background-color: #ddd;
    }

    /* Create an active/current "tab button" class */
    .tab button.active {
        background-color: #ccc;
    }

    /* Style the tab content */
    .tabcontent {
        float: left;
        padding: 0px 12px;
        border: 1px solid #ccc;
        width: 82%;
        border-left: none;
        height: 300px;
        margin-top: 80px;

    }

    /* The Modal (background) */
    .modal {
        display: none;
        /* Hidden by default */
        position: fixed;
        /* Stay in place */
        z-index: 1;
        /* Sit on top */
        padding-top: 100px;
        /* Location of the box */
        left: 0;
        top: 0;
        width: 100%;
        /* Full width */
        height: 100%;
        /* Full height */
        overflow: auto;
        /* Enable scroll if needed */
        background-color: rgb(0, 0, 0);
        /* Fallback color */
        background-color: rgba(0, 0, 0, 0.4);
        /* Black w/ opacity */
    }

    /* Modal Content */
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
    }

    /* The Close Button */
    .close {
        color: #aaaaaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
    }

    .service_title{
	font-weight: bold;
    font-size: 26px;
    margin: 30px;
}

#th{
	font-weight: bold;
    font-size: 14px;
    color: white;
}

</style>


<body>


    <header>

        <nav class="navbar fixed-top navbar-expand-lg navbar-dark blue-gradient scrolling-navbar"
            style="position: fixed;">
  <a class="navbar-brand" href="#"><img src="img/dashboard/logo.png" style = "width: 56px;"></a>            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Pricing</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Opinions</a>
                    </li>
                </ul>
                <ul class="navbar-nav nav-flex-icons">
                    <li class="nav-item">
                        <a class="nav-link"><i class="fab fa-facebook-f"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"><i class="fab fa-twitter"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"><i class="fab fa-instagram"></i></a>
                    </li>
                </ul>
            </div>
        </nav>

    </header>


    <div class="tab">
        <button class="tablinks" onclick="openCity(event, 'London')" id="defaultOpen"> <img src="img/dashboard/jimmy.jpg" style = "width: 45px;height: 39px;border-radius: 44px;"><span style = "margin: 12px;font-size: 16px;">David Grey</span> <a style = " margin: 59px; font-size: 12px;top: -15px; position: relative;">Admin</a></button>

		<a href = "dashboard.html"><button class="tablinks" onclick="openCity(event, 'London')" id="defaultOpen">Dashboard <i class="fas fa-home"></i></button></a>
		<a href = "servicerequest.html"><button class="tablinks" >Providers <i class="fas fa-user-tie"></i></button></a>
		<a href = "members.html"> <button class="tablinks" >Members <i class="fas fa-users"></i></button></a>
	   <button class="tablinks" >Transaction</button>
	   <button class="tablinks" >Earnings</button>
	   <a href = "serviceapplication.html"> <button class="tablinks" >Applications</button></a>	  <a href = "service.html"><button class="tablinks">Services</button></a> 
	  </div>

    <div id="London" class="tabcontent">

        <button type="button" style = "margin: 19px;border: 2px solid #3e9cdd;" class="btn btn-rounded btn-lg">Application<i class="fas fa-scroll"></i></button>

        <form class="form-inline active-pink-4 chumsSearch" style = "float:right" >
            <input class="form-control form-control-sm mr-3 w-75" type="text" placeholder="Search"
              aria-label="Search" id = "myInput">
            <i class="fas fa-search" aria-hidden="true"></i> 
        </form>
        <!-- <div class="table-responsive text-nowrap">
			 
			  <table class="table table-striped" id="example">
		  
			
				<thead>
				  <tr>
					<th>Profile</th>
					<th>First firstName</th>
					<th>Last firstName</th>
					<th>Gender</th>
					<th>Home Address</th>
					<th>Mobile Number</th>
					<th>Email</th>
					<th>Action</th>
					
				  </tr>
				</thead>
				
				<tbody id="hmd-table">
				  
				</tbody>
				
		  
			  </table>
		
			</div> -->
        <div class="table-responsive">
            <!-- Trigger/Open The Modal -->

            <table class="table" id="example">
                <thead style = "    background-color: #3fa2e2;">
                    <tr>
                        <th id = "th">Profile</th>
                        <th id = "th">First Name</th>
                        <th id = "th">Last Name</th>
                        <th id = "th">Status</th>
                        <th id = "th">Mobile Number</th>
                        <th id = "th">Email</th>
                        <!-- <th>Primary Care</th> -->
                        <th id = "th">Accept</th>
                        <th id = "th">Reject</th>
                    </tr>
                </thead>
                <tbody id="hmd-table">

                </tbody>
            </table>
        </div>
    </div>
 
    <!-- <button class="btn btn blue-gradient btn-rounded btnEdit" style="color:white">Add</button></a></td> -->


    <div id="modalRemovebox" class="modal">
        <div class="modal-background"></div>
        <div class="modal-card">
            <header class="modal-card-head">
                <p class="modal-card-title">Do you want to Delete this?</p>
                <button class="btnClose delete" aria-label="close"></button>
            </header>

            <div class="modal-card-foot chums-save">
                <button id="removeThis" class="btn blue-gradient" style="color:white">Yes</button>
                <!-- <button id="btnSavetime" class="button is-success">Save changes</button> -->
                <button id="cancelRemove" class="btn btn-mdb-color" style="color:white">No</button>
            </div>
        </div>

    </div>



    <div id="modal" class="modal"  >
        <div class="modal-background"></div>
        <div class="modal-card">
            <header class="modal-card-head blue-gradient" style = "width: 379px;    display: block;
            margin-left: auto;
            margin-right: auto;">
                <p class="modal-card-title">Status succesfully change</p>
               
            </header>
            <section class="modal-card-body " style = "display:none" >
                <div class="field">
                    <label class="label">Status</label>
                    <div class="control">
                        <input type="hidden" id="txtType">
                        <input type="hidden" id="txtKey">
                        <input class="input" id="txtfirstfirstName" type="text" >
                        <input class="input" id="profilerole" type="text" >

                    </div>

                </div>
               
            </section>
            <div class="modal-card-foot chums-save" style = "width: 379px;    display: block;
            margin-left: auto;
            margin-right: auto;">
                <button id="btnSave" class="btn blue-gradient btnSaverole" style="color:white">ok</button>   
                    
            </div>
        </div>

    </div>



    <!-- The Modal -->
    <div id="myModal" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
            <span class="close">&times;</span>
            <p>Some text in the Modal..</p>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-2.2.4.min.js"
        integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.0/firebase.js"></script>
    <script>
        var config = {
            apiKey: "AIzaSyB-QqOCEreJ1Yn9EWb84NdwJ4E-FvKfC7I",
            authDomain: "edok-1c5a9.firebaseapp.com",
            databaseURL: "https://edok-1c5a9.firebaseio.com",
            projectId: "edok-1c5a9",
            storageBucket: "edok-1c5a9.appspot.com",
            messagingSenderId: "628540937215",
            appId: "1:628540937215:web:6d7ad591c271f0d0394dca",
            measurementId: "G-LH94VM5FTM"
        };
        firebase.initializeApp(config);
        var database = firebase.database();

        database.ref('serviceProviderApplications/').on('child_added', function (data) {
            add_data_table(data.val().selfiePhotoURL, data.val().firstName, data.val().lastName, data.val().status, data.val().mobileNumber, data.val().email, data.key);
            var lastkey = data.key;
            nextkey = parseInt(lastkey) + 1;

        });

        database.ref('serviceProviderApplications/').on('child_changed', function (data) {
            update_data_table(data.val().firstName, data.val().lastName, data.val().status, data.val().mobileNumber, data.val().email, data.key)
        });

        database.ref('serviceProviderApplications/').on('child_removed', function (data) {
            remove_data_table(data.key)
        });

        function add_data_table(selfiePhotoURL, firstName, lastName, status, mobileNumber, email, key) {
            $("#hmd-table").append('<tr  id="' + key + '"><td><img style = "width:30px" src = ' + selfiePhotoURL + '/></td><td>' + firstName + '</td><td>' + lastName + '</td><td class = "statusHere">' + status + '</td><td>' + mobileNumber + '</td> <td>' + email + '</td>   <td><a href="#" data-key="' + key + '" class=" btnEdit"> <button class="btn btn-outline-primary btn-rounded waves-effect" style = "color:white">Accept</button></a></td><td><a href="#" data-key="' + key + '" class=" btnRemove"> <button class="btn btn-outline-danger btn-rounded waves-effect" style = "color:white" id="myBtn">Reject</button></a></td></tr>');

        }


        function update_data_table(firstName, lastName, status, mobileNumber, email) {
            $("#hmd-table #" + key).html('  <th scope="row"></th> <td><img style = "width:30px" src = ' + selfiePhotoURL + '/></td><td>' + firstName + '</td><td>' + lastName + '</td><td>' + status + '</td> <td>' + mobileNumber + '</td> <td>' + email + '</td> <td><a href="#" data-key="' + key + '" class=" btnEdit"> <button class="btn btn blue-gradient btn-rounded" style = "color:white">Edit</button></a></td><td><a href="#" data-key="' + key + '" class=" btnRemove"> <button class="btn btn-outline-danger btn-rounded waves-effect" style = "color:white" id="myBtn">Reject</button></a></td>');
        }



        function remove_data_table(key) {
            $("#hmd-table #" + key).remove();
        }

        function new_data(firstName, lastName, status, mobileNumber, email, key) {
            database.ref('serviceProviderApplications/' + key).set({
                firstName: firstName,
                lastName: lastName,
                status: status,
                mobileNumber: mobileNumber,
                email: email,
                primaryCare: primaryCare
            });
        }


        function update_data(status) {
            database.ref('serviceProviderApplications/' + key).update({
                status: status,
              
            });
            
        }


        function update_dataprofile(role) {
            database.ref('profile/' + key).update({
               role:role,
              
            });
            
        }



        $("#btnAdd").click(function () {
            $("#txtfirstfirstName").val("");
            $("#txtlastfirstName").val("");
            $("#txtgender").val("");
            $("#txtnumber").val("");

            $("#txtType").val("N");
            $("#txtKey").val("0");
            $("#modal").addClass("is-active");


        });
        $("#btnSave").click(function () {
            if ($("#txtType").val() == 'N') {
                database.ref('serviceProviderApplications/').once("value").then(function (snapshot) {
                    if (snapshot.numChildren() == 0) {
                        nextkey = 1;
                    }
                    new_data($("#txtfirstfirstName").val(), $("#txtlastfirstName").val(), $("#txtgender").val(), $("#txtaddress").val(), $("#txtnumber").val(), nextkey);

                    window.location.reload();
                });
            }
            else {
                update_data($("#txtfirstfirstName").val());
                window.location.reload();
            }
            $("#btnClose").click();
        });

        $(".btnSaverole").click(function () {

if ($("#txtType").val() == 'N') {
    database.ref('profile/').once("value").then(function (snapshot) {
        if (snapshot.numChildren() == 0) {
            nextkey = 1;
        }
        new_data($("#txtfirstfirstName").val(), $("#txtlastfirstName").val(), $("#txtgender").val(), $("#txtaddress").val(), $("#txtnumber").val(), nextkey);

        window.location.reload();
    });

}
else {
    update_dataprofile($("#profilerole").val());
    window.location.reload();


}
$("#btnClose").click();


});



        $(document).on("click", ".btnEdit", function (event) {
            event.preventDefault();
            key = $(this).attr("data-key");
            database.ref('serviceProviderApplications/' + key).once("value").then(function (snapshot) {

                $("#txtfirstfirstName").val("approved");
            //  $('txtfirstfirstName').text('test')
                $("#txtType").val("E");
                $("#txtKey").val(key);
            });


            database.ref('profile/' + key).once("value").then(function (snapshot) {

$("#profilerole").val("provider");
//  $('txtfirstfirstName').text('test')
$("#txtType").val("E");
$("#txtKey").val(key);
});

            $("#modal").addClass("is-active");
            
        });

 

        $(document).on("click", "#removeThis", function (event) {
            event.preventDefault();
            key = $(this).attr("data-key");
            database.ref('services/' + key).remove();
            $("#modalRemovebox").removeClass("is-active")
        })

        $(document).on("click", ".btnRemove", function (event) {
            $("#modalRemovebox").addClass("is-active")
        })

		$(document).ready(function(){
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#hmd-table tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});	
    </script>



</body>

</html>