<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>House MD</title>
	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
	<!-- Bootstrap core CSS -->
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<!-- Material Design Bootstrap -->
	<link href="css/mdb.min.css" rel="stylesheet">
	<!-- Your custom styles (optional) -->
	<link href="css/style.css" rel="stylesheet">
	<link href="style.css" rel="stylesheet">
	<script src="https://code.jquery.com/jquery-2.1.3.js"
		integrity="sha256-goy7ystDD5xbXSf+kwL4eV6zOPJCEBD1FBiCElIm+U8=" crossorigin="anonymous"></script>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.8/vue.min.js"></script>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
    <!-- <script defer src="https://use.fontawesome.com/releases/v5.0.0/js/all.js"></script> -->
    
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>

<link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css">
</head>
<style>
* {box-sizing: border-box}
body {font-family: "Lato", sans-serif;}

/* Style the tab */
.tab {
  float: left;
  border: 1px solid #ccc;
  background: linear-gradient(40deg, #303f9f, #45cafc);
  width: 14%;
  height: 100vh;
  margin-top: 75px;
}

/* Style the buttons inside the tab */
.tab button {
  display: block;
  background-color: inherit;
  color: white;
  padding: 22px 16px;
  width: 100%;
  border: none;
  outline: none;
  text-align: left;
  cursor: pointer;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current "tab button" class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  float: left;
  padding: 0px 12px;
  border: 1px solid #ccc;
  width: 82%;
  border-left: none;
  height: 300px;
  margin-top: 80px;

}

#th{
	font-weight: bold;
    font-size: 14px;
    color: white;
}

</style>


<body>


	<header>

		<nav class="navbar fixed-top navbar-expand-lg navbar-dark blue-gradient scrolling-navbar" style = "position: fixed;">
		  <a class="navbar-brand" href="#"><strong>Navbar</strong></a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		  </button>
		  <div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav mr-auto">
			  <li class="nav-item active">
				<a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link" href="#">Features</a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link" href="#">Pricing</a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link" href="#">Opinions</a>
			  </li>
			</ul>
			<ul class="navbar-nav nav-flex-icons">
			  <li class="nav-item">
				<a class="nav-link"><i class="fab fa-facebook-f"></i></a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link"><i class="fab fa-twitter"></i></a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link"><i class="fab fa-instagram"></i></a>
			  </li>
			</ul>
		  </div>
		</nav>
	  
	  </header>

	  <div class="tab">
		<button class="tablinks" onclick="openCity(event, 'London')" id="defaultOpen"> <img src="img/dashboard/jimmy.jpg" style = "width: 45px;height: 39px;border-radius: 44px;"><span style = "margin: 12px;font-size: 16px;">David Grey</span> <a style = " margin: 59px; font-size: 12px;top: -15px; position: relative;">Admin</a></button>

		<a href = "dashboard.html"><button class="tablinks" onclick="openCity(event, 'London')" id="defaultOpen">Dashboard <i class="fas fa-home"></i></button></a>
		<a href = "servicerequest.html"><button class="tablinks" >Providers <i class="fas fa-user-tie"></i></button></a>
		<a href = "members.html"> <button class="tablinks" >Members <i class="fas fa-users"></i></button></a>
	   <button class="tablinks" >Transaction</button>
	   <button class="tablinks" >Earnings</button>
	   <a href = "serviceapplication.html"> <button class="tablinks" >Applications</button></a>	  <a href = "service.html"><button class="tablinks">Services</button></a> 
	  </div>
	  
	  <div id="London" class="tabcontent">
		  <!-- <div class="table-responsive text-nowrap">
			 
			  <table class="table table-striped" id="example">
		  
			
				<thead>
				  <tr>
					<th>Profile</th>
					<th>First Name</th>
					<th>Last Name</th>
					<th>Gender</th>
					<th>Home Address</th>
					<th>Mobile Number</th>
					<th>Email</th>
					<th>Action</th>
					
				  </tr>
				</thead>
				
				<tbody id="hmd-table">
				  
				</tbody>
				
		  
			  </table>
		
			</div> -->
 
			<button type="button" style = "margin: 19px;border: 2px solid #3e9cdd;" class="btn btn-rounded btn-lg">Service Request<i class="fas fa-scroll"></i></button>

		
			<form class="form-inline active-pink-4 chumsSearch"  style = "float:right">
				<input class="form-control form-control-sm mr-3 w-75" type="text" placeholder="Search"
				  aria-label="Search" id = "myInput">
				<i class="fas fa-search" aria-hidden="true"></i>
			<!-- <button class="btn aqua-gradient btn-rounded btn-sm my-0 " type="submit" onclick = "searchId()" >Search</button></a>  -->
			  
			
			</form>

			<div class="table-responsive">
  <table class="table" id="example">
    <thead style = "    background-color: #3fa2e2;">
      <tr id = "th">
		<th id = "th" >Profile</th>
		<th id = "th">First Name</th>
		<th id = "th">Last Name</th>
		<th id = "th">Address</th>
		<th id = "th">Service Status</th>
		<th id = "th">Service Name</th>
        <th id = "th">Action</th>
        <th id = "th">Action</th>
      </tr>
    </thead>
    <tbody id="hmd-table">
     
    </tbody>
  </table>
</div>
	  </div>
		
      </section>
      
      <div id="modalRemovebox" class="modal">
		<div class="modal-background"></div>
		<div class="modal-card">
			<header class="modal-card-head">
				<p class="modal-card-title">Do you want to Delete this?</p>
				<button class="btnClose delete" aria-label="close"></button>
			</header>
		
			<div class="modal-card-foot chums-save">
				<button id="removeThis" class="btn blue-gradient" style = "color:white">Yes</button>
				<!-- <button id="btnSavetime" class="button is-success">Save changes</button> -->
				<button id="cancelRemove" class="btn btn-mdb-color" style = "color:white">No</button>
			</div>
		</div>

	</div>


	 
		<div id="modal" class="modal">
			<div class="modal-background"></div>
			<div class="modal-card">
				<header class="modal-card-head  blue-gradient">
					<p class="modal-card-title">Person Form</p>
					<button class="btnClose delete" aria-label="close"></button>
				</header>
				<section class="modal-card-body">
					<div class="field">
						<label class="label">First Name</label>
						<div class="control">
							<input type="hidden" id="txtType">
							<input type="hidden" id="txtKey">
							<input class="input" id="txtfirstname" type="text" placeholder="Chums ID">
						</div>
					
					</div>
					<div class="field">
						<label class="label">Last Name</label>
						<div class="control">
							<input class="input" id="txtlastname" type="text" placeholder="username">

						</div>
					
					</div>
					<div class="field">
						<label class="label">Address</label>
						<div class="control">
							<input class="input" id="txtgender" type="text" placeholder="score">
						</div>
						<!-- <p class="help"></p> -->
					</div>

					<div class="field">
						<label class="label">Service Status</label>
						<div class="control">
							<input class="input" id="txtaddress" type="text" placeholder="score">
						</div>
						<!-- <p class="help"></p> -->
					</div>

					<div class="field">
						<label class="label">Service Name</label>
						<div class="control">
							<input class="input" id="txtnumber" type="text" placeholder="score">
						</div>
						<!-- <p class="help"></p> -->
					</div>
				</section>
				<div class="modal-card-foot chums-save">
					<button id="btnSave" class="btn blue-gradient" style = "color:white">Save changes</button>
					<!-- <button id="btnSavetime" class="button is-success">Save changes</button> -->
					<button id="btnClose" class="btn btn-mdb-color" style = "color:white">Cancel</button>
				</div>
			</div>
		</div>
	</section>
	<script src="https://code.jquery.com/jquery-2.2.4.min.js"
		integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
	<script src="https://www.gstatic.com/firebasejs/4.10.0/firebase.js"></script>
	<script>
		var config = {
		apiKey: "AIzaSyB-QqOCEreJ1Yn9EWb84NdwJ4E-FvKfC7I",
		authDomain: "edok-1c5a9.firebaseapp.com",
		databaseURL: "https://edok-1c5a9.firebaseio.com",
		projectId: "edok-1c5a9",
		storageBucket: "edok-1c5a9.appspot.com",
		messagingSenderId: "628540937215",
		appId: "1:628540937215:web:6d7ad591c271f0d0394dca",
		measurementId: "G-LH94VM5FTM"
	};
		firebase.initializeApp(config);
		var database = firebase.database();

		database.ref('activeServiceRequests/').on('child_added', function (data) {
			add_data_table(data.val().requesterPhoto,data.val().requesterFname, data.val().requesterLname, data.val().requesterAddress,data.val().serviceStatus, data.val().serviceName, data.val().email, data.key);
			var lastkey = data.key;
			nextkey = parseInt(lastkey) + 1;
         
		});

		database.ref('activeServiceRequests/').on('child_changed', function (data) {
			update_data_table(data.val().requesterFname, data.val().requesterLname, data.val().gender, data.val().requesterAddress, data.val().serviceStatus, data.val().serviceName, data.key)
		});

		database.ref('activeServiceRequests/').on('child_removed', function (data) {
			remove_data_table(data.key)
		});

		function add_data_table(requesterPhoto, requesterFname, requesterLname, requesterAddress, serviceStatus, serviceName, email, key) {
			$("#hmd-table").append('<tr  id="'+key+'"><td><img style = "width:30px" src = ' + requesterPhoto + '/></td><td>' + requesterFname + '</td><td>' + requesterLname + '</td><td>' + requesterAddress + '</td><td>' + serviceStatus + '</td> <td>' + serviceName + '</td> <td><a href="#" data-key="' + key + '" class=" btnEdit"> <button class="btn btn blue-gradient btn-rounded" style = "color:white">Edit</button></a></td><td><a href="#" data-key="' + key + '" class=""> <button class="btn btn blue-gradient btn-rounded btnRemove" style = "color:white">Remove</button></a></td></tr>');
		
 
        
        }



		function update_data_table(requesterPhoto, requesterFname, requesterLname, requesterAddress, serviceName, mobileNumber, email) {
			$("#hmd-table #"+ key).html('  <th scope="row"></th> <td><img style = "width:30px" src = ' + requesterPhoto + '/></td><td>' + requesterFname + '</td><td>' + requesterLname + '</td><td>' + requesterAddress + '</td> <td>' + serviceStatus + '</td> <td>' + serviceName + '</td> <td><a href="#" data-key="' + key + '" class=" btnEdit"> <button class="btn btn blue-gradient btn-rounded" style = "color:white">Edit</button></a></td><td>' + email + '</td><td><a href="#" data-key="' + key + '" class=" btnEdit"> <button class="btn btn blue-gradient btn-rounded" style = "color:white">Remove</button></a></td><td><a href="#" data-key="' + key + '" class=" "> <button class="btn btn blue-gradient btn-rounded btnRemove" style = "color:white">Remove</button></a></td>');
		}



		function remove_data_table(key) {
			$("#hmd-table #"+ key).remove();
		}

		function new_data(requesterFname, requesterLname, requesterAddress ,serviceStatus, serviceName, email, key) {
			database.ref('activeServiceRequests/' + key).set({
				requesterPhoto:requesterPhoto,
				lastName: lastName,
				gender: gender,
			});
		}


		function update_data(requesterFname, requesterLname, requesterAddress, serviceStatus , serviceName, email) {
			database.ref('activeServiceRequests/' + key).update({
				requesterFname:requesterFname,
				requesterLname: requesterLname,
				requesterAddress: requesterAddress,
				serviceStatus: serviceStatus,
				serviceName:serviceName
			});
		}


		$("#btnAdd").click(function () {
			$("#txtfirstname").val("");
			$("#txtlastname").val("");
			$("#txtgender").val("");
			$("#txtnumber").val("");

			$("#txtType").val("N");
			$("#txtKey").val("0");
			$("#modal").addClass("is-active");


		});
		$("#btnSave").click(function () {

			if ($("#txtType").val() == 'N') {
				database.ref('activeServiceRequests/').once("value").then(function (snapshot) {
					if (snapshot.numChildren() == 0) {
						nextkey = 1;
					}
					new_data($("#txtfirstname").val(), $("#txtlastname").val(), $("#txtgender").val(),$("#txtaddress").val(),$("#txtnumber").val(),nextkey);

					window.location.reload();
				});
			}
			else {
				update_data($("#txtfirstname").val(), $("#txtlastname").val(), $("#txtgender").val(), $("#txtaddress").val(), $("#txtnumber").val(),$("#txtKey").val());
				window.location.reload();
		
			}
			$("#btnClose").click();


		});
		$(document).on("click", ".btnEdit", function (event) {
			event.preventDefault();
			key = $(this).attr("data-key");
			database.ref('activeServiceRequests/' + key).once("value").then(function (snapshot) {
				$("#txtfirstname").val(snapshot.val().requesterFname);
				$("#txtlastname").val(snapshot.val().requesterLname);
				$("#txtgender").val(snapshot.val().requesterAddress);
				$("#txtaddress").val(snapshot.val().serviceStatus);
				$("#txtnumber").val(snapshot.val().serviceName);
				$("#txtType").val("E");
				$("#txtKey").val(key);
			});
			$("#modal").addClass("is-active");
		});


		$(document).on("click", "#removeThis", function (event) {
			event.preventDefault();
			key = $(this).attr("data-key");
			database.ref('activeServiceRequests/' + key).remove();
			$("#modalRemovebox").removeClass("is-active")
		})

		$(document).on("click", ".btnRemove", function (event) {		
			$("#modalRemovebox").addClass("is-active")
		})


		$(document).on("click", "#btnClose", function () {		
			$("#modal").removeClass("is-active")
		})

		$(document).ready(function(){
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#hmd-table tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});	

	</script>



</body>

</html>
